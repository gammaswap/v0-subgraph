type User @entity {
  id: ID!
  address: Bytes!
  depositedPools: [Bytes!]!
  loans: [BigInt!]!
}

type Token @entity {
  id: ID! # address of token
  name: String!
  symbol: String!
  decimals: Int!
  totalSupply: BigInt!
  totalLiquidity: BigDecimal!
  tradeVolume: BigDecimal!
  lastPriceUSD: BigDecimal
  timestamp: BigInt!
  block: BigInt!
  txCount: Int! # transactions for all pools
}

# pool events
type Pool @entity {
  id: ID!
  address: Bytes! # pool addr
  cfmm: Bytes! # native pool
  implementationID: Int! # protocol ID for now
  implementation: Bytes!
  symbol: String
  name: String
  tokens: [Token!]!
  txCount: Int!
  createdAtTimestamp: BigInt!
  createdAtBlock: BigInt!
  lpTokenBalance: BigInt!
  lpTokenBorrowed: BigInt!
  lpTokenBorrowedPlusInterest: BigInt!
  accFeeIndex: BigInt!
  lpInvariant: BigInt!
  borrowedInvariant: BigInt!
}

type PoolSnapshot @entity {
  id: ID!
  address: Bytes! # address
  lpTokenBalance: BigInt!
  lpTokenBorrowed: BigInt!
  lpTokenBorrowedPlusInterest: BigInt!
  lpTokenTotal: BigInt!
  lpInvariant: BigInt!
  borrowedInvariant: BigInt!
  lpTotalInvariant: BigInt!
  lpUtilizationRate: BigDecimal!
  suppliedLiquidity: BigInt!
  borrowedLiquidity: BigInt!
  lastBlockNumber: BigInt!
  blockNumber: BigInt!
  price: BigInt!
  totalCollateral: BigInt!
}

type Loan @entity {
  id: ID!
  pool: Pool! # address of pool corresponds to id of Pool entity
  tokenId: BigInt!
  tokensHeld: [BigInt!]!
  liquidity: BigInt!
  lpTokens: BigInt!
  rateIndex: BigInt! # accFeeIndex
  collateral: BigInt!
  loanToValue: BigDecimal!
  blockNumber: BigInt!
}

type LoanSnapshot @entity {
  id: ID!
  pool: Pool! # address of pool corresponds to id of Pool entity
  tokenId: BigInt!
  tokensHeld: [BigInt!]!
  liquidity: BigInt!
  lpTokens: BigInt!
  rateIndex: BigInt! # accFeeIndex
  collateral: BigInt!
  loanToValue: BigDecimal!
  blockNumber: BigInt!
}

type GSFactory @entity {
  id: ID! # factory address
  totalVolumeUSD: BigDecimal!
  totalVolumeETH: BigDecimal!
  totalLiquidityUSD: BigDecimal!
  totalLiquidityETH: BigDecimal!
  totalSuppliedUSD: BigDecimal!
  totalSuppliedETH: BigDecimal!
  totalBorrowedUSD: BigDecimal!
  totalBorrowedETH: BigDecimal!
  totalCollateralUSD: BigDecimal! # not sure if we need this
  totalCollateralETH: BigDecimal! # not sure if we need this
  txCount: Int!
  poolCount: Int!
}

enum PoolType {
  UNISWAPV2
  BALANCER_5050
  BALANCER_8020
  SUSHISWAP
}
